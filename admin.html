<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Panel Admin - Diccionario AR</title>
  <link rel="icon" type="image/png" href="favicon-ar.png">
  <link rel="shortcut icon" href="favicon-ar.ico" type="image/x-icon">
  <style>
    @font-face {
      font-family: 'MiddleOfApril';
      src: url('Middle-of-April.ttf') format('truetype');
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      padding: 20px;
      font-family: 'Segoe UI', sans-serif;
      background:
        linear-gradient(to bottom, rgba(0,0,0,0.85), rgba(0,0,0,0.95)),
        url('FONDOOO.jpeg') no-repeat center center fixed;
      background-size: cover;
      background-attachment: fixed;
      color: #f1f1f1;
    }
    body.light-mode {
      background:
        linear-gradient(to bottom, rgba(255,255,255,0.85), rgba(255,255,255,0.95)),
        url('fondo-claro.png') no-repeat center center fixed;
      background-size: cover;
      color: #111;
    }
    h1 {
      font-family: 'MiddleOfApril', cursive;
      font-size: 3rem;
      color: #3ae374;
      text-align: center;
      margin-bottom: 30px;
    }
    .contenedor, .login {
      max-width: 1000px;
      margin: 0 auto;
      background-color: #1e1e1e;
      padding: 30px;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
    }
    body.light-mode .contenedor,
    body.light-mode .login {
      background-color: #ffffffcc;
      color: #111;
    }
    #buscador, .login input {
      margin-bottom: 10px;
      width: 100%;
      padding: 10px;
      border-radius: 8px;
      border: none;
      background-color: #2a2a2a;
      color: white;
      font-size: 16px;
    }
    body.light-mode #buscador,
    body.light-mode .login input {
      background-color: #eee;
      color: #111;
    }
    .mostrar-toggle {
      background: none;
      border: none;
      color: #3ae374;
      font-size: 14px;
      cursor: pointer;
      margin-bottom: 20px;
      display: inline-block;
    }
    body.light-mode .mostrar-toggle {
      color: #111;
    }
    button {
      background-color: #444;
      color: white;
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-weight: bold;
      cursor: pointer;
      margin-top: 10px;
    }
    button:hover {
      background-color: #3ae374;
      color: black;
    }
    body.light-mode button {
      color: #111;
    }
    #adminPanel { display: none; }
    #btnSugerencias { display: none; }
    .azul { color: #1877f2; }
    .rojo { color: #ff5c39; }
    tr:nth-child(even) td { background-color: #242424; }
    body.light-mode tr:nth-child(even) td,
    body.light-mode table td {
      background-color: #f9f9f9;
      color: #111;
    }
    table th {
      background-color: #007acc;
      color: white;
      cursor: pointer;
    }
    body.light-mode table th {
      background-color: #007acc;
      color: white;
    }
    input:focus { outline: 2px solid #3ae374; }
    .btn-fijo-sugerencias {
      position: fixed;
      top: 20px;
      right: 20px;
      background-color: #ff69b4;
      color: white;
      border: none;
      border-radius: 50px;
      padding: 12px 20px;
      font-weight: bold;
      cursor: pointer;
      z-index: 1000;
    }
    .btn-fijo-sugerencias:hover {
      background-color: #ff85c1;
      color: black;
    }
    body.light-mode .btn-fijo-sugerencias {
      background-color: #e91e63;
      color: white;
    }
    body.light-mode .btn-fijo-sugerencias:hover {
      background-color: #f06292;
      color: black;
    }
    @media (max-width: 768px) {
      table, thead, tbody, th, td, tr {
        display: block;
      }
      thead tr {
        display: none;
      }
      tr {
        margin-bottom: 15px;
        border-bottom: 2px solid #444;
      }
      td {
        padding: 10px;
        text-align: right;
        position: relative;
      }
      td::before {
        content: attr(data-label);
        position: absolute;
        left: 10px;
        width: 45%;
        padding-left: 10px;
        font-weight: bold;
        text-align: left;
        color: #3ae374;
      }
    }
  </style>
</head>
<body onload="document.getElementById('clave').focus(); if (localStorage.getItem('modoClaro') === '1') document.body.classList.add('light-mode');">
  <h1><span class="azul">PANEL</span> <span class="rojo">ADMIN</span></h1>
  <div class="login" id="loginPanel">
    <form onsubmit="verificarClave(); return false;">
      <input type="password" id="clave" placeholder="Ingrese la contrase√±a">
      <button type="button" class="mostrar-toggle" onclick="toggleMostrar()">MOSTRAR</button>
      <button type="submit">Ingresar</button>
      <button type="button" onclick="window.location.href='index.html'" style="background-color: #777;">Volver al inicio</button>
    </form>
  </div>
  <div class="contenedor" id="adminPanel">
    <input type="text" id="buscador" placeholder="Buscar por t√©rmino..." onkeyup="filtrarTabla()">
    <table id="tablaTerminos">
      <thead>
        <tr>
          <th onclick="ordenarTabla(0)">T√©rmino</th>
          <th onclick="ordenarTabla(1)">Traducci√≥n</th>
          <th onclick="ordenarTabla(2)">Pronunciaci√≥n</th>
          <th onclick="ordenarTabla(3)">Categor√≠a</th>
          <th onclick="ordenarTabla(4)">Definici√≥n</th>
          <th onclick="ordenarTabla(5)">Sin√≥nimos</th>
          <th onclick="ordenarTabla(6)">Tipo</th>
          <th onclick="ordenarTabla(7)">Forma farmac√©utica</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr><td colspan="9" style="text-align:center;">Cargando t√©rminos...</td></tr>
      </tbody>
    </table>
    <div id="paginacion" style="text-align:center; margin-top:20px;"></div>
    <button onclick="window.location.href='index.html'">Volver al inicio</button>
  </div>
  <button id="btnSugerencias" class="btn-fijo-sugerencias" onclick="window.location.href='revisar-sugerencias.html'">üì¨ Ver sugerencias</button>

  <script>
    const API_URL = 'https://script.google.com/macros/s/AKfycbzAzMs8JEWCQM0fzZobajM3iozSpTVnyS8mDtJuccWVmeu-rg4M3ed41fXWXEEBpz8/exec';
    let todasLasFilas = [];
    let paginaActual = 1;
    const filasPorPagina = 10;
    const tbody = document.querySelector("#tablaTerminos tbody");

    function toggleMostrar() {
      const input = document.getElementById("clave");
      const boton = document.querySelector(".mostrar-toggle");
      if (input.type === "password") {
        input.type = "text";
        boton.textContent = "OCULTAR";
      } else {
        input.type = "password";
        boton.textContent = "MOSTRAR";
      }
    }

    function verificarClave() {
      const clave = document.getElementById("clave").value;
      if (clave === "ARdic@2025") {
        document.getElementById("loginPanel").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
        document.getElementById("btnSugerencias").style.display = "block";
        cargarDatos();
      } else {
        alert("Contrase√±a incorrecta");
        document.getElementById("clave").value = "";
      }
    }

    function cargarDatos() {
      fetch(API_URL)
        .then(res => res.json())
        .then(data => {
          todasLasFilas = [];
          for (const termino in data) {
            const fila = data[termino];
            const tr = document.createElement("tr");
            tr.innerHTML = `
              <td>${termino}</td>
              <td>${fila["Traducci√≥n"] || ""}</td>
              <td>${fila["Pronunciaci√≥n"] || ""}</td>
              <td>${fila["Categor√≠a"] || ""}</td>
              <td>${fila["Definici√≥n"] || ""}</td>
              <td>${fila["Sin√≥nimos"] || ""}</td>
              <td>${fila["Tipo de t√©rmino"] || ""}</td>
              <td>${fila["Forma farmac√©utica"] || ""}</td>`;
            const editarBtn = `<button onclick=\"editarFila(this)\">‚úèÔ∏è</button>`;
            const eliminarBtn = `<button onclick=\"eliminarFila(this)\">üóëÔ∏è</button>`;
            tr.innerHTML += `<td>${editarBtn} ${eliminarBtn}</td>`;
            todasLasFilas.push(tr);
          }
          mostrarPagina(paginaActual);
        })
        .catch(err => {
          tbody.innerHTML = `<tr><td colspan='9'>‚ùå Error al cargar los t√©rminos.</td></tr>`;
          console.error("Error cargando t√©rminos:", err);
        });
    }

    function mostrarPagina(pagina) {
      tbody.innerHTML = "";
      const inicio = (pagina - 1) * filasPorPagina;
      const fin = inicio + filasPorPagina;
      const filasMostrar = todasLasFilas.slice(inicio, fin);
      filasMostrar.forEach(f => tbody.appendChild(f));
      generarPaginacion();
    }

    function generarPaginacion() {
      const totalPaginas = Math.ceil(todasLasFilas.length / filasPorPagina);
      const paginacion = document.getElementById("paginacion");
      paginacion.innerHTML = "";

      const btnAnterior = document.createElement("button");
      btnAnterior.innerHTML = "&lt;";
      btnAnterior.disabled = paginaActual === 1;
      btnAnterior.onclick = () => {
        if (paginaActual > 1) {
          paginaActual--;
          mostrarPagina(paginaActual);
        }
      };
      paginacion.appendChild(btnAnterior);

      let inicio = Math.max(1, paginaActual - 1);
      let fin = Math.min(totalPaginas, paginaActual + 1);
      if (paginaActual >= totalPaginas - 1) {
        inicio = totalPaginas - 2;
        fin = totalPaginas;
      }
      if (inicio < 1) inicio = 1;

      for (let i = inicio; i <= fin; i++) {
        const btn = document.createElement("button");
        btn.textContent = i;
        btn.style.margin = "0 3px";
        btn.onclick = () => {
          paginaActual = i;
          mostrarPagina(paginaActual);
        };
        if (i === paginaActual) {
          btn.style.backgroundColor = "#3ae374";
          btn.style.color = "black";
        }
        paginacion.appendChild(btn);
      }

      const btnSiguiente = document.createElement("button");
      btnSiguiente.innerHTML = "&gt;";
      btnSiguiente.disabled = paginaActual === totalPaginas;
      btnSiguiente.onclick = () => {
        if (paginaActual < totalPaginas) {
          paginaActual++;
          mostrarPagina(paginaActual);
        }
      };
      paginacion.appendChild(btnSiguiente);
    }

    function filtrarTabla() {
      const filtro = document.getElementById("buscador").value.toLowerCase();
      const filtradas = todasLasFilas.filter(fila => {
        const texto = fila.cells[0].innerText.toLowerCase();
        return texto.includes(filtro);
      });
      tbody.innerHTML = "";
      filtradas.forEach(f => tbody.appendChild(f));
    }
  </script>
</body>
</html>
